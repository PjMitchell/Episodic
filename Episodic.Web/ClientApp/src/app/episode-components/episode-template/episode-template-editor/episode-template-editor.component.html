<ng-template #formTemplate  let-formComponent="form">
    <form [formGroup]="formComponent">
        <mat-form-field appearance="fill" >
            <mat-label>Name</mat-label>
            <input matInput formControlName="name">
        </mat-form-field>
        <br>
        <mat-form-field appearance="fill" class="app-full-width-input">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description"></textarea>
        </mat-form-field>
        <mat-form-field appearance="fill" class="app-full-width-input">
            <mat-label>Description Template</mat-label>
            <app-enhanced-text-editor formControlName="descriptionTemplate"></app-enhanced-text-editor>       
        </mat-form-field>
        <mat-form-field appearance="fill">
            <mat-label>Required Components</mat-label>
            <mat-select formControlName="requiredComponents" multiple>
              <mat-option *ngFor="let option of availableOptions" [value]="option.value">{{option.description}}</mat-option>
            </mat-select>
          </mat-form-field>
          
            <button mat-button (click)="add()">Add</button> 
            <div *ngFor="let stageForm of formComponent.controls.stages.controls;let stageIndex = index" [formGroup]="stageForm">
                <h2>Stage {{stageIndex+1}}</h2>
                <mat-form-field appearance="fill" >
                    <mat-label>Name</mat-label>
                    <input matInput formControlName="name">
                </mat-form-field>
                <mat-form-field appearance="fill" class="app-full-width-input">
                    <mat-label>Description Template</mat-label>
                    <app-enhanced-text-editor formControlName="descriptionTemplate"></app-enhanced-text-editor>       
                </mat-form-field>
                <button mat-button (click)="remove(stageIndex)">Remove</button> 
           
            </div>
    </form>
</ng-template>
<app-component-editor-shell 
    [isNew]="isNew$ | async" 
    [id]="id$ | async" 
    [formTemplate]="formTemplate"
    [componentForm]=form 
    (saveClicked)="save()"
    (backClicked)="back()"
    >
</app-component-editor-shell>
